/* Контейнер для ячейки */
.gameCell {
  width: 60px;
  height: 60px;
  border: 2px solid #d3d6da;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 2rem;
  font-weight: bold;
  text-transform: uppercase;
  user-select: none;

  /* Убираем все глобальные transition, оставляем только для бордера при вводе */
  transition: border-color 0.1s ease-out;

  backface-visibility: hidden;
  -webkit-backface-visibility: hidden;
  transform-style: preserve-3d;
}

/* МГНОВЕННОЕ ПОДПРЫГИВАНИЕ ПРИ ВВОДЕ */
/* Мы гарантируем отсутствие задержки (animation-delay: 0) */
.gameCell:not(.flip):not(:empty) {
  animation: pop 0.1s ease-out forwards;
  animation-delay: 0s !important;
  border-color: #878a8c;
}

@keyframes pop {
  0% {
    transform: scale(1);
  }
  50% {
    transform: scale(1.1);
  }
  100% {
    transform: scale(1);
  }
}

/* --- ПЕРЕВОРОТ (FLIP) --- */
.flip {
  /* Анимация переворота запускается только здесь */
}

@keyframes flip-reveal {
  0% {
    transform: rotateX(0);
  }
  50% {
    transform: rotateX(90deg);
  }
  100% {
    transform: rotateX(0);
  }
}

@keyframes reveal-correct {
  0%,
  50% {
    background-color: transparent;
    border-color: #d3d6da;
  }
  51%,
  100% {
    background-color: #6aaa64;
    border-color: #6aaa64;
    color: white;
  }
}
@keyframes reveal-present {
  0%,
  50% {
    background-color: transparent;
    border-color: #d3d6da;
  }
  51%,
  100% {
    background-color: #c9b458;
    border-color: #c9b458;
    color: white;
  }
}
@keyframes reveal-absent {
  0%,
  50% {
    background-color: transparent;
    border-color: #d3d6da;
  }
  51%,
  100% {
    background-color: #787c7e;
    border-color: #787c7e;
    color: white;
  }
}

/* Применяем анимации переворота */
.flip.correct {
  animation: flip-reveal 0.6s ease-in forwards, reveal-correct 0.6s ease-in forwards;
}
.flip.present {
  animation: flip-reveal 0.6s ease-in forwards, reveal-present 0.6s ease-in forwards;
}
.flip.absent {
  animation: flip-reveal 0.6s ease-in forwards, reveal-absent 0.6s ease-in forwards;
}

/* ЗАДЕРЖКИ ТОЛЬКО ДЛЯ КЛАССА FLIP */
/* Это исключает влияние на ввод букв */
.cell-0.flip {
  animation-delay: 0s !important;
}
.cell-1.flip {
  animation-delay: 0.2s !important;
}
.cell-2.flip {
  animation-delay: 0.4s !important;
}
.cell-3.flip {
  animation-delay: 0.6s !important;
}
.cell-4.flip {
  animation-delay: 0.8s !important;
}

/* --- ТРЯСКА И ПОБЕДА --- */
.shake {
  animation: shake 0.5s linear;
}
@keyframes shake {
  10%,
  90% {
    transform: translateX(-1px);
  }
  20%,
  80% {
    transform: translateX(2px);
  }
  30%,
  50%,
  70% {
    transform: translateX(-4px);
  }
  40%,
  60% {
    transform: translateX(4px);
  }
}

.winner {
  animation: bounce 0.6s ease forwards;
}
.win-cell-0 {
  animation-delay: 0s !important;
}
.win-cell-1 {
  animation-delay: 0.1s !important;
}
.win-cell-2 {
  animation-delay: 0.2s !important;
}
.win-cell-3 {
  animation-delay: 0.3s !important;
}
.win-cell-4 {
  animation-delay: 0.4s !important;
}

@keyframes bounce {
  0%,
  20% {
    transform: translateY(0);
  }
  40% {
    transform: translateY(-20px);
  }
  50% {
    transform: translateY(5px);
  }
  100% {
    transform: translateY(0);
  }
}
